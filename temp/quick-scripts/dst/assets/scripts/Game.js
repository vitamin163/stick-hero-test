
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/Game.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '060eccP2o9PwYEnb4pvEUjk', 'Game');
// scripts/Game.js

"use strict";

var async = require("async");

cc.Class({
  "extends": cc.Component,
  properties: {
    newGroundPrefab: {
      "default": null,
      type: cc.Prefab
    },
    redPointPrefab: {
      "default": null,
      type: cc.Prefab
    },
    stickPrefab: {
      "default": null,
      type: cc.Prefab
    },
    ground: {
      "default": null,
      type: cc.Node
    },
    player: {
      "default": null,
      type: cc.Node
    },
    scoreDisplay: {
      "default": null,
      type: cc.Label
    },
    playerDestination: 'none',
    isMoving: false,
    touchStart: false,
    touchEnd: false,
    collision: false,
    stick: null,
    newGround: null,
    beyond: -500,
    startPosition: -300
  },
  // LIFE-CYCLE CALLBACKS:
  onLoad: function onLoad() {
    this.stick = this.spawnStick();
    this.newGround = this.spawnNewGround();
    this.player.getComponent('Player').game = this;
    this.score = 0;
  },
  onEnable: function onEnable() {
    this.node.once(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);
    this.node.once(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);
  },
  onTouchStart: function onTouchStart() {
    this.touchStart = true;
    this.touchEnd = false;
  },
  onTouchEnd: function onTouchEnd() {
    this.touchStart = false;
    this.touchEnd = true;

    if (this.calculateCollision()) {
      this.successAction();
    } else {
      this.failAction();
    }
  },
  gainScore: function gainScore() {
    this.scoreDisplay.string = 'Score: ' + this.score;
  },
  calculateCollision: function calculateCollision() {
    var startCollisionPoint = this.newGround.x - this.newGround.width / 2;
    var endCollisionPoint = this.newGround.x + this.newGround.width / 2;
    var startCollisionRedPoint = this.newGround.x - this.redPointPrefab.data.width / 2;
    var endCollisionRedPoint = this.newGround.x + this.redPointPrefab.data.width / 2;
    var destination = this.stick.x + this.stick.height;
    var isCollision = destination >= startCollisionPoint && destination <= endCollisionPoint;
    var isPerfect = destination >= startCollisionRedPoint && destination <= endCollisionRedPoint;

    if (isCollision && !isPerfect) {
      this.score += 1;
    } else if (isPerfect) {
      this.score += 2;
    }

    return isCollision;
  },
  successAction: function successAction() {
    var _this = this;

    cc.tween(this.stick).to(0.5, {
      rotation: 90
    }).call(function () {
      cc.tween(_this.player).to(1, {
        position: cc.v2(_this.playerDestination, _this.stick.y)
      }).call(function () {
        cc.tween(_this.newGround).to(1, {
          position: cc.v2(_this.startPosition, _this.ground.y)
        }).start();
      }).call(function () {
        cc.tween(_this.player).to(1, {
          position: cc.v2(_this.startPosition + _this.newGround.width / 2 - 20, _this.stick.y)
        }).start();
      }).call(function () {
        cc.tween(_this.stick).to(1, {
          position: cc.v2(_this.startPosition - _this.stick.height, _this.stick.y)
        }).start();
      }).call(function () {
        cc.tween(_this.ground).to(1, {
          position: cc.v2(-800, _this.ground.y)
        }).call(function () {
          return _this.ground.destroy();
        }).call(function () {
          return _this.ground = _this.newGround;
        }).call(function () {
          _this.stick.active = false;
          _this.stick = _this.spawnStick();
          _this.newGround = _this.spawnNewGround();

          _this.node.once(cc.Node.EventType.TOUCH_START, _this.onTouchStart, _this);

          _this.node.once(cc.Node.EventType.TOUCH_END, _this.onTouchEnd, _this);
        }).start();
      }).start();
    }).call(function () {
      return _this.gainScore();
    }).start().start();
  },
  failAction: function failAction() {
    var _this2 = this;

    cc.tween(this.stick).to(0.5, {
      rotation: 90
    }).call(function () {
      cc.tween(_this2.player).to(1, {
        position: cc.v2(_this2.player.x + _this2.stick.height, _this2.stick.y)
      }).call(function () {
        cc.tween(_this2.stick).to(0.5, {
          rotation: 180
        }).start();
      }).call(function () {
        cc.tween(_this2.player).by(0.5, {
          position: cc.v2(0, -350)
        }).delay(1).call(function () {
          return cc.director.loadScene('game');
        }).start();
      }).start();
    }).start();
  },
  randomInteger: function randomInteger(min, max) {
    var rand = min + Math.random() * (max + 1 - min);
    return Math.floor(rand);
  },
  spawnRedPoint: function spawnRedPoint() {
    return cc.instantiate(this.redPointPrefab);
  },
  spawnStick: function spawnStick() {
    var newStick = cc.instantiate(this.stickPrefab);
    this.node.addChild(newStick);
    newStick.anchorY = 0;
    newStick.y = this.ground.y + this.ground.height / 2;
    newStick.x = this.startPosition + this.ground.width / 2;
    newStick.getComponent('Stick').game = this;
    return newStick;
  },
  spawnNewGround: function spawnNewGround() {
    var newGround = cc.instantiate(this.newGroundPrefab);
    this.node.addChild(newGround);
    var newRedPoint = this.spawnRedPoint();
    newGround.addChild(newRedPoint);
    newRedPoint.y = this.ground.height / 2 - newRedPoint.height / 2;
    var minWidthNewGround = 30;
    var maxWidthNewGround = 150;
    newGround.width = this.randomInteger(minWidthNewGround, maxWidthNewGround);
    newGround.setPosition(this.getNewGroundPosition(newGround.width));
    this.playerDestination = newGround.x + newGround.width / 2 - 20;
    return newGround;
  },
  getNewGroundPosition: function getNewGroundPosition(newGroundWidth) {
    var groundY = this.ground.y;
    var minX = -(this.node.width / 2) + 150 + newGroundWidth / 2 + 5;
    var maxX = this.node.width / 2 - newGroundWidth / 2;
    var randX = this.randomInteger(minX, maxX);
    return cc.v2(randX, groundY);
  },
  start: function start() {},
  update: function update(dt) {}
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcR2FtZS5qcyJdLCJuYW1lcyI6WyJhc3luYyIsInJlcXVpcmUiLCJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsIm5ld0dyb3VuZFByZWZhYiIsInR5cGUiLCJQcmVmYWIiLCJyZWRQb2ludFByZWZhYiIsInN0aWNrUHJlZmFiIiwiZ3JvdW5kIiwiTm9kZSIsInBsYXllciIsInNjb3JlRGlzcGxheSIsIkxhYmVsIiwicGxheWVyRGVzdGluYXRpb24iLCJpc01vdmluZyIsInRvdWNoU3RhcnQiLCJ0b3VjaEVuZCIsImNvbGxpc2lvbiIsInN0aWNrIiwibmV3R3JvdW5kIiwiYmV5b25kIiwic3RhcnRQb3NpdGlvbiIsIm9uTG9hZCIsInNwYXduU3RpY2siLCJzcGF3bk5ld0dyb3VuZCIsImdldENvbXBvbmVudCIsImdhbWUiLCJzY29yZSIsIm9uRW5hYmxlIiwibm9kZSIsIm9uY2UiLCJFdmVudFR5cGUiLCJUT1VDSF9TVEFSVCIsIm9uVG91Y2hTdGFydCIsIlRPVUNIX0VORCIsIm9uVG91Y2hFbmQiLCJjYWxjdWxhdGVDb2xsaXNpb24iLCJzdWNjZXNzQWN0aW9uIiwiZmFpbEFjdGlvbiIsImdhaW5TY29yZSIsInN0cmluZyIsInN0YXJ0Q29sbGlzaW9uUG9pbnQiLCJ4Iiwid2lkdGgiLCJlbmRDb2xsaXNpb25Qb2ludCIsInN0YXJ0Q29sbGlzaW9uUmVkUG9pbnQiLCJkYXRhIiwiZW5kQ29sbGlzaW9uUmVkUG9pbnQiLCJkZXN0aW5hdGlvbiIsImhlaWdodCIsImlzQ29sbGlzaW9uIiwiaXNQZXJmZWN0IiwidHdlZW4iLCJ0byIsInJvdGF0aW9uIiwiY2FsbCIsInBvc2l0aW9uIiwidjIiLCJ5Iiwic3RhcnQiLCJkZXN0cm95IiwiYWN0aXZlIiwiYnkiLCJkZWxheSIsImRpcmVjdG9yIiwibG9hZFNjZW5lIiwicmFuZG9tSW50ZWdlciIsIm1pbiIsIm1heCIsInJhbmQiLCJNYXRoIiwicmFuZG9tIiwiZmxvb3IiLCJzcGF3blJlZFBvaW50IiwiaW5zdGFudGlhdGUiLCJuZXdTdGljayIsImFkZENoaWxkIiwiYW5jaG9yWSIsIm5ld1JlZFBvaW50IiwibWluV2lkdGhOZXdHcm91bmQiLCJtYXhXaWR0aE5ld0dyb3VuZCIsInNldFBvc2l0aW9uIiwiZ2V0TmV3R3JvdW5kUG9zaXRpb24iLCJuZXdHcm91bmRXaWR0aCIsImdyb3VuZFkiLCJtaW5YIiwibWF4WCIsInJhbmRYIiwidXBkYXRlIiwiZHQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFuQjs7QUFFQUMsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLGVBQWUsRUFBRTtBQUNiLGlCQUFTLElBREk7QUFFYkMsTUFBQUEsSUFBSSxFQUFFTCxFQUFFLENBQUNNO0FBRkksS0FEVDtBQU1SQyxJQUFBQSxjQUFjLEVBQUU7QUFDWixpQkFBUyxJQURHO0FBRVpGLE1BQUFBLElBQUksRUFBRUwsRUFBRSxDQUFDTTtBQUZHLEtBTlI7QUFXUkUsSUFBQUEsV0FBVyxFQUFFO0FBQ1QsaUJBQVMsSUFEQTtBQUVUSCxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ007QUFGQSxLQVhMO0FBZ0JSRyxJQUFBQSxNQUFNLEVBQUU7QUFDSixpQkFBUyxJQURMO0FBRUpKLE1BQUFBLElBQUksRUFBRUwsRUFBRSxDQUFDVTtBQUZMLEtBaEJBO0FBcUJSQyxJQUFBQSxNQUFNLEVBQUU7QUFDSixpQkFBUyxJQURMO0FBRUpOLE1BQUFBLElBQUksRUFBRUwsRUFBRSxDQUFDVTtBQUZMLEtBckJBO0FBeUJSRSxJQUFBQSxZQUFZLEVBQUU7QUFDVixpQkFBUyxJQURDO0FBRVZQLE1BQUFBLElBQUksRUFBRUwsRUFBRSxDQUFDYTtBQUZDLEtBekJOO0FBNkJSQyxJQUFBQSxpQkFBaUIsRUFBRSxNQTdCWDtB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TGdDO0FBQ2pDLFFBQU1DLE9BQU8sR0FBRyxLQUFLNUUsTUFBTCxDQUFZa0QsQ0FBNUI7QUFDQSxRQUFNMkIsSUFBSSxHQUFHLEVBQUUsS0FBS3hELElBQUwsQ0FBVWMsS0FBVixHQUFrQixDQUFwQixJQUF5QixHQUF6QixHQUFnQ3dDLGNBQWMsR0FBRyxDQUFqRCxHQUFzRCxDQUFuRTtBQUNBLFFBQU1HLElBQUksR0FBSSxLQUFLekQsSUFBTCxDQUFVYyxLQUFWLEdBQWtCLENBQW5CLEdBQXlCd0MsY0FBYyxHQUFHLENBQXZEO0FBQ0EsUUFBTUksS0FBSyxHQUFHLEtBQUtyQixhQUFMLENBQW1CbUIsSUFBbkIsRUFBeUJDLElBQXpCLENBQWQ7QUFDQSxXQUFPdkYsRUFBRSxDQUFDMEQsRUFBSCxDQUFNOEIsS0FBTixFQUFhSCxPQUFiLENBQVA7QUFDSCxHQXBNSTtBQXdNTHpCLEVBQUFBLEtBeE1LLG1CQXdNRyxDQUVQLENBMU1JO0FBNE1MNkIsRUFBQUEsTUE1TUssa0JBNE1FQyxFQTVNRixFQTRNTSxDQUVWO0FBOU1JLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhc3luYyA9IHJlcXVpcmUoXCJhc3luY1wiKTtcclxuXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbmV3R3JvdW5kUHJlZmFiOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlByZWZhYlxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHJlZFBvaW50UHJlZmFiOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlByZWZhYlxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHN0aWNrUHJlZmFiOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlByZWZhYlxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdyb3VuZDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgcGxheWVyOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNjb3JlRGlzcGxheToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGxheWVyRGVzdGluYXRpb246ICdub25lJyxcclxuICAgICAgICBpc01vdmluZzogZmFsc2UsXHJcbiAgICAgICAgdG91Y2hTdGFydDogZmFsc2UsXHJcbiAgICAgICAgdG91Y2hFbmQ6IGZhbHNlLFxyXG4gICAgICAgIGNvbGxpc2lvbjogZmFsc2UsXHJcbiAgICAgICAgc3RpY2s6IG51bGwsXHJcbiAgICAgICAgbmV3R3JvdW5kOiBudWxsLFxyXG4gICAgICAgIGJleW9uZDogLTUwMCxcclxuICAgICAgICBzdGFydFBvc2l0aW9uOiAtMzAwLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBMSUZFLUNZQ0xFIENBTExCQUNLUzpcclxuXHJcbiAgICBvbkxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5zdGljayA9IHRoaXMuc3Bhd25TdGljaygpO1xyXG4gICAgICAgIHRoaXMubmV3R3JvdW5kID0gdGhpcy5zcGF3bk5ld0dyb3VuZCgpO1xyXG4gICAgICAgIHRoaXMucGxheWVyLmdldENvbXBvbmVudCgnUGxheWVyJykuZ2FtZSA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zY29yZSA9IDA7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uRW5hYmxlKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5vbmNlKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCB0aGlzLm9uVG91Y2hTdGFydCwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uY2UoY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCB0aGlzLm9uVG91Y2hFbmQsIHRoaXMpO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgb25Ub3VjaFN0YXJ0KCkge1xyXG4gICAgICAgIHRoaXMudG91Y2hTdGFydCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy50b3VjaEVuZCA9IGZhbHNlO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgb25Ub3VjaEVuZCgpIHtcclxuICAgICAgICB0aGlzLnRvdWNoU3RhcnQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnRvdWNoRW5kID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5jYWxjdWxhdGVDb2xsaXNpb24oKSkge1xyXG4gICAgICAgICAgICB0aGlzLnN1Y2Nlc3NBY3Rpb24oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZhaWxBY3Rpb24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgZ2FpblNjb3JlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zY29yZURpc3BsYXkuc3RyaW5nID0gJ1Njb3JlOiAnICsgdGhpcy5zY29yZTtcclxuICAgIH0sXHJcblxyXG4gICAgY2FsY3VsYXRlQ29sbGlzaW9uKCkge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0Q29sbGlzaW9uUG9pbnQgPSB0aGlzLm5ld0dyb3VuZC54IC0gdGhpcy5uZXdHcm91bmQud2lkdGggLyAyO1xyXG4gICAgICAgIGNvbnN0IGVuZENvbGxpc2lvblBvaW50ID0gdGhpcy5uZXdHcm91bmQueCArIHRoaXMubmV3R3JvdW5kLndpZHRoIC8gMjtcclxuICAgICAgICBjb25zdCBzdGFydENvbGxpc2lvblJlZFBvaW50ID0gdGhpcy5uZXdHcm91bmQueCAtIHRoaXMucmVkUG9pbnRQcmVmYWIuZGF0YS53aWR0aCAvIDI7XHJcbiAgICAgICAgY29uc3QgZW5kQ29sbGlzaW9uUmVkUG9pbnQgPSB0aGlzLm5ld0dyb3VuZC54ICsgdGhpcy5yZWRQb2ludFByZWZhYi5kYXRhLndpZHRoIC8gMjtcclxuICAgICAgICBjb25zdCBkZXN0aW5hdGlvbiA9IHRoaXMuc3RpY2sueCArIHRoaXMuc3RpY2suaGVpZ2h0O1xyXG4gICAgICAgIGNvbnN0IGlzQ29sbGlzaW9uID0gZGVzdGluYXRpb24gPj0gc3RhcnRDb2xsaXNpb25Qb2ludCAmJiBkZXN0aW5hdGlvbiA8PSBlbmRDb2xsaXNpb25Qb2ludDtcclxuICAgICAgICBjb25zdCBpc1BlcmZlY3QgPSBkZXN0aW5hdGlvbiA+PSBzdGFydENvbGxpc2lvblJlZFBvaW50ICYmIGRlc3RpbmF0aW9uIDw9IGVuZENvbGxpc2lvblJlZFBvaW50O1xyXG4gICAgICAgIGlmIChpc0NvbGxpc2lvbiAmJiAhaXNQZXJmZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NvcmUgKz0gMTtcclxuICAgICAgICB9IGVsc2UgaWYgKGlzUGVyZmVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLnNjb3JlICs9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpc0NvbGxpc2lvbjtcclxuICAgIH0sXHJcblxyXG4gICAgc3VjY2Vzc0FjdGlvbigpIHtcclxuICAgICAgICBjYy50d2Vlbih0aGlzLnN0aWNrKS50bygwLjUsIHsgcm90YXRpb246IDkwIH0pXHJcbiAgICAgICAgICAgIC5jYWxsKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNjLnR3ZWVuKHRoaXMucGxheWVyKS50bygxLCB7IHBvc2l0aW9uOiBjYy52Mih0aGlzLnBsYXllckRlc3RpbmF0aW9uLCB0aGlzLnN0aWNrLnkpIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy50d2Vlbih0aGlzLm5ld0dyb3VuZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50bygxLCB7IHBvc2l0aW9uOiBjYy52Mih0aGlzLnN0YXJ0UG9zaXRpb24sIHRoaXMuZ3JvdW5kLnkpIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3RhcnQoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy50d2Vlbih0aGlzLnBsYXllcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50bygxLCB7IHBvc2l0aW9uOiBjYy52MigodGhpcy5zdGFydFBvc2l0aW9uICsgdGhpcy5uZXdHcm91bmQud2lkdGggLyAyKSAtIDIwLCB0aGlzLnN0aWNrLnkpIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3RhcnQoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy50d2Vlbih0aGlzLnN0aWNrKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvKDEsIHsgcG9zaXRpb246IGNjLnYyKHRoaXMuc3RhcnRQb3NpdGlvbiAtIHRoaXMuc3RpY2suaGVpZ2h0LCB0aGlzLnN0aWNrLnkpIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3RhcnQoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy50d2Vlbih0aGlzLmdyb3VuZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50bygxLCB7IHBvc2l0aW9uOiBjYy52MigtODAwLCB0aGlzLmdyb3VuZC55KSB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoKCkgPT4gdGhpcy5ncm91bmQuZGVzdHJveSgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoKCkgPT4gdGhpcy5ncm91bmQgPSB0aGlzLm5ld0dyb3VuZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0aWNrLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RpY2sgPSB0aGlzLnNwYXduU3RpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0dyb3VuZCA9IHRoaXMuc3Bhd25OZXdHcm91bmQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGUub25jZShjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgdGhpcy5vblRvdWNoU3RhcnQsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZS5vbmNlKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgdGhpcy5vblRvdWNoRW5kLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3RhcnQoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAuc3RhcnQoKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2FsbCgoKSA9PiB0aGlzLmdhaW5TY29yZSgpKS5zdGFydCgpXHJcbiAgICAgICAgICAgIC5zdGFydCgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZmFpbEFjdGlvbigpIHtcclxuICAgICAgICBjYy50d2Vlbih0aGlzLnN0aWNrKS50bygwLjUsIHsgcm90YXRpb246IDkwIH0pXHJcbiAgICAgICAgICAgIC5jYWxsKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNjLnR3ZWVuKHRoaXMucGxheWVyKS50bygxLCB7IHBvc2l0aW9uOiBjYy52Mih0aGlzLnBsYXllci54ICsgdGhpcy5zdGljay5oZWlnaHQsIHRoaXMuc3RpY2sueSkgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2FsbCgoKSA9PiB7IGNjLnR3ZWVuKHRoaXMuc3RpY2spLnRvKDAuNSwgeyByb3RhdGlvbjogMTgwIH0pLnN0YXJ0KCkgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2FsbCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLnR3ZWVuKHRoaXMucGxheWVyKS5ieSgwLjUsIHsgcG9zaXRpb246IGNjLnYyKDAsIC0zNTApIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGVsYXkoMSkuY2FsbCgoKSA9PiBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2dhbWUnKSkuc3RhcnQoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC5zdGFydCgpXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAuc3RhcnQoKTtcclxuXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICByYW5kb21JbnRlZ2VyKG1pbiwgbWF4KSB7XHJcbiAgICAgICAgY29uc3QgcmFuZCA9IG1pbiArIE1hdGgucmFuZG9tKCkgKiAobWF4ICsgMSAtIG1pbik7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IocmFuZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNwYXduUmVkUG9pbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIGNjLmluc3RhbnRpYXRlKHRoaXMucmVkUG9pbnRQcmVmYWIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzcGF3blN0aWNrKCkge1xyXG4gICAgICAgIGNvbnN0IG5ld1N0aWNrID0gY2MuaW5zdGFudGlhdGUodGhpcy5zdGlja1ByZWZhYik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKG5ld1N0aWNrKTtcclxuICAgICAgICBuZXdTdGljay5hbmNob3JZID0gMDtcclxuICAgICAgICBuZXdTdGljay55ID0gdGhpcy5ncm91bmQueSArIHRoaXMuZ3JvdW5kLmhlaWdodCAvIDI7XHJcbiAgICAgICAgbmV3U3RpY2sueCA9IHRoaXMuc3RhcnRQb3NpdGlvbiArIHRoaXMuZ3JvdW5kLndpZHRoIC8gMjtcclxuICAgICAgICBuZXdTdGljay5nZXRDb21wb25lbnQoJ1N0aWNrJykuZ2FtZSA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ld1N0aWNrO1xyXG4gICAgfSxcclxuXHJcbiAgICBzcGF3bk5ld0dyb3VuZCgpIHtcclxuICAgICAgICBjb25zdCBuZXdHcm91bmQgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLm5ld0dyb3VuZFByZWZhYik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKG5ld0dyb3VuZCk7XHJcbiAgICAgICAgY29uc3QgbmV3UmVkUG9pbnQgPSB0aGlzLnNwYXduUmVkUG9pbnQoKTtcclxuICAgICAgICBuZXdHcm91bmQuYWRkQ2hpbGQobmV3UmVkUG9pbnQpO1xyXG4gICAgICAgIG5ld1JlZFBvaW50LnkgPSB0aGlzLmdyb3VuZC5oZWlnaHQgLyAyIC0gbmV3UmVkUG9pbnQuaGVpZ2h0IC8gMjtcclxuICAgICAgICBjb25zdCBtaW5XaWR0aE5ld0dyb3VuZCA9IDMwO1xyXG4gICAgICAgIGNvbnN0IG1heFdpZHRoTmV3R3JvdW5kID0gMTUwO1xyXG4gICAgICAgIG5ld0dyb3VuZC53aWR0aCA9IHRoaXMucmFuZG9tSW50ZWdlcihtaW5XaWR0aE5ld0dyb3VuZCwgbWF4V2lkdGhOZXdHcm91bmQpO1xyXG4gICAgICAgIG5ld0dyb3VuZC5zZXRQb3NpdGlvbih0aGlzLmdldE5ld0dyb3VuZFBvc2l0aW9uKG5ld0dyb3VuZC53aWR0aCkpO1xyXG4gICAgICAgIHRoaXMucGxheWVyRGVzdGluYXRpb24gPSAobmV3R3JvdW5kLnggKyBuZXdHcm91bmQud2lkdGggLyAyKSAtIDIwO1xyXG4gICAgICAgIHJldHVybiBuZXdHcm91bmQ7XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBnZXROZXdHcm91bmRQb3NpdGlvbihuZXdHcm91bmRXaWR0aCkge1xyXG4gICAgICAgIGNvbnN0IGdyb3VuZFkgPSB0aGlzLmdyb3VuZC55O1xyXG4gICAgICAgIGNvbnN0IG1pblggPSAtKHRoaXMubm9kZS53aWR0aCAvIDIpICsgMTUwICsgKG5ld0dyb3VuZFdpZHRoIC8gMikgKyA1O1xyXG4gICAgICAgIGNvbnN0IG1heFggPSAodGhpcy5ub2RlLndpZHRoIC8gMikgLSAobmV3R3JvdW5kV2lkdGggLyAyKTtcclxuICAgICAgICBjb25zdCByYW5kWCA9IHRoaXMucmFuZG9tSW50ZWdlcihtaW5YLCBtYXhYKTtcclxuICAgICAgICByZXR1cm4gY2MudjIocmFuZFgsIGdyb3VuZFkpO1xyXG4gICAgfSxcclxuXHJcblxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlKGR0KSB7XHJcblxyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==